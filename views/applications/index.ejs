<%- include('../partials/header')%>
<%- include('../js/dateFormat.ejs')%>

<div class="d-flex justify-content-center">
    <div class="col-sm-10 col-md-9 col-lg-8">
        <div class="d-flex justify-content-between mb-3 mr-auto">
            <ul class="nav nav-pills" id="pills-applications-tab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="pills-all-tab" data-toggle="pill" href="#pills-all" role="tab" aria-controls="pills-all" aria-selected="true">Toutes les candidatures</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-inprogress-tab" data-toggle="pill" href="#pills-inprogress" role="tab" aria-controls="pills-inprogress" aria-selected="false">En cours</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-accepted-tab" data-toggle="pill" href="#pills-accepted" role="tab" aria-controls="pills-accepted" aria-selected="false">Acceptées</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-refused-tab" data-toggle="pill" href="#pills-refused" role="tab" aria-controls="pills-refused" aria-selected="false">Refusées</a>
                </li>
            </ul>
            <a href="/applications/new"><button type="button" class="btn btn-success btn-md">Ajouter une nouvelle candidature</button></a>
        </div>
        <div class="tab-content" id="pills-applications-content">
            <div class="tab-pane fade show active" id="pills-all" role="tabpanel" aria-labelledby="pills-all-tab">
                <% applications.forEach(application => { %>
                    <div class="card mb-3">
                        <div class="card-body">
                            <h3 class="card-title"><a href="/companies/<%=application.company.id%>"><%=application.company.name%></a></h3>
                            <p class="card-text text-secondary">
                                Créé : <%=writeDateFR(application.postedAt)%><br>
                                <%-writeLastUpdateDate(application.updates)%>
                                Etat : <%-writeCurrentState(application.currentState)%>
                                <a href="/applications/<%=application._id%>"><button class="btn btn-sm btn-info float-right">Plus d'infos</button></a>
                            </p>
                        </div>
                    </div>
                <% }); %>
            </div>
            <div class="tab-pane fade" id="pills-inprogress" role="tabpanel" aria-labelledby="pills-inprogress-tab">
                <% applications.forEach(application => { %>
                    <% if(application.currentState === 0) {%>
                        <div class="card mb-3">
                            <div class="card-body">
                                <h3 class="card-title"><a href="/companies/<%=application.company.id%>"><%=application.company.name%></a></h3>
                                <p class="card-text text-secondary">
                                    Créé : <%=writeDateFR(application.postedAt)%><br>
                                    <%-writeLastUpdateDate(application.updates)%>
                                    Etat : <%-writeCurrentState(application.currentState)%>
                                    <a href="/applications/<%=application._id%>"><button class="btn btn-sm btn-info float-right">Plus d'infos</button></a>
                                </p>
                            </div>
                        </div>
                    <% }; %>
                <% }); %>
            </div>
            <div class="tab-pane fade" id="pills-accepted" role="tabpanel" aria-labelledby="pills-accepted-tab">
                <% applications.forEach(application => { %>
                    <% if(application.currentState === 1) {%>
                        <div class="card mb-3">
                            <div class="card-body">
                                <h3 class="card-title"><a href="/companies/<%=application.company.id%>"><%=application.company.name%></a></h3>
                                <p class="card-text text-secondary">
                                    Créé : <%=writeDateFR(application.postedAt)%><br>
                                    <%-writeLastUpdateDate(application.updates)%>
                                    Etat : <%-writeCurrentState(application.currentState)%>
                                    <a href="/applications/<%=application._id%>"><button class="btn btn-sm btn-info float-right">Plus d'infos</button></a>
                                </p>
                            </div>
                        </div>
                    <% }; %>
                <% }); %>
            </div>
            <div class="tab-pane fade" id="pills-refused" role="tabpanel" aria-labelledby="pills-refused-tab">
                <% applications.forEach(application => { %>
                    <% if(application.currentState === 2) {%>
                        <div class="card mb-3">
                            <div class="card-body">
                                <h3 class="card-title"><a href="/companies/<%=application.company.id%>"><%=application.company.name%></a></h3>
                                <p class="card-text text-secondary">
                                    Créé : <%=writeDateFR(application.postedAt)%><br>
                                    <%-writeLastUpdateDate(application.updates)%>
                                    Etat : <%-writeCurrentState(application.currentState)%>
                                    <a href="/applications/<%=application._id%>"><button class="btn btn-sm btn-info float-right">Plus d'infos</button></a>
                                </p>
                            </div>
                        </div>
                    <% }; %>
                <% }); %>
            </div>
        </div>
    </div>
</div>
<%- include('../partials/footer')%>